import * as mapBlock from "./mapBlock.js";
import * as spawnerBuilding from "./spawnerBuilding.js";
import { getDistance } from "./basic.js";
import { GameEvent } from "./gameEvent.js";
import { Team } from "./teamClass.js";
import { MapBlockIndex } from "./position.js";
import { randomRange } from "./basic.js";
console.log("Map Builder Module Loading...");
export class MapBuilder {
    constructor(mapSize) {
        this._mapSize = mapSize;
        this._integerMapSize = Math.ceil(this._mapSize);
    }
    static buildLine(position1, position2, width = 1) {
        const buildVertical = () => {
            if (position1.getY() == position2.getY())
                return;
            let deltaX = (position2.getX() - position1.getX()) / Math.abs(position2.getY() - position1.getY());
            let deltaY = Math.abs(position2.getY() - position1.getY()) / (position2.getY() - position1.getY());
            let itemX = position1.getX();
            for (var y = position1.getY(); y != position2.getY(); y += deltaY) {
                for (var dx = -width; dx <= width; dx++) {
                    new mapBlock.NormalMapBlock(itemX + dx, y);
                }
                itemX += deltaX;
            }
        };
        const buildHorizontal = () => {
            if (position1.getX() == position2.getX())
                return;
            let deltaX = Math.abs(position2.getX() - position1.getX()) / (position2.getX() - position1.getX());
            let deltaY = (position2.getY() - position1.getY()) / Math.abs(position2.getX() - position1.getX());
            let itemY = position1.getY();
            for (var x = position1.getX(); x != position2.getX(); x += deltaX) {
                for (var dy = -width; dy <= width; dy++) {
                    new mapBlock.NormalMapBlock(x, itemY + dy);
                }
                itemY += deltaY;
            }
        };
        buildVertical();
        buildHorizontal();
    }
    buildNewMap() {
        console.log("---=== < 建立新地圖 > ===---");
        GameEvent.triggerMapReset();
    }
    runFunctionOnEveryPosition(processFunction) {
        for (var x = -this._integerMapSize; x <= this._integerMapSize; x++) {
            for (var y = -this._integerMapSize; y <= this._integerMapSize; y++) {
                if (!this.positionInMapRange(x, y))
                    continue;
                processFunction(this, x, y);
            }
        }
    }
    positionInMapRange(x, y) {
        return (getDistance(x, y, 0, 0) <= this._mapSize + Math.log2(this._mapSize));
    }
}
export class SeedRandomBuilder extends MapBuilder {
    constructor(mapSize, mapSeed, iterationTimes = 4) {
        super(mapSize);
        this._mapSeed = mapSeed;
        this._seedArg = SeedRandomBuilder.seedRandomFunction(this._mapSeed, 4);
        this._iterationTimes = iterationTimes;
    }
    static buildRandomMap(mapSize, seed, iterationTimes) {
        new SeedRandomBuilder(mapSize, seed, iterationTimes).buildNewMap();
    }
    static seedRandomFunction(seed, alpha = 2, iteration = 1) {
        alpha = Math.pow(10, alpha);
        for (var i = 0; i <= iteration; i++) {
            seed = Math.floor(Math.pow(seed + alpha, 2) / alpha) % alpha;
        }
        return seed;
    }
    buildNewMap() {
        super.buildNewMap();
        this.processBuildMap();
        this.processCreateItem();
    }
    processBuildMap() {
        let linkPosList = [];
        const positionProcessFunction = (builder, x, y) => {
            let seedBuilder = builder;
            if (seedBuilder.checkPositionCanBuildBlock(seedBuilder, x, y)) {
                linkPosList.push({ x: x, y: y });
            }
        };
        const buildOneTime = () => {
            linkPosList.splice(0, linkPosList.length);
            this.runFunctionOnEveryPosition(positionProcessFunction);
            for (var i = 0; i < linkPosList.length; i++) {
                new mapBlock.NormalMapBlock(linkPosList[i].x, linkPosList[i].y);
            }
        };
        for (var i = 1; i <= this._iterationTimes; i++) {
            buildOneTime();
        }
    }
    processCreateItem() {
        let teamCounter = 0;
        const positionCreateItemFunction = (builder, x, y) => {
            if (mapBlock.MapBlock.getBlock(new MapBlockIndex(x, y)) == null)
                return;
            let posSeed = SeedRandomBuilder.seedRandomFunction(builder.getPositionSeed(x, y), 4, 2);
            if (posSeed % 67 != 23)
                return;
            createItemWithSeed(posSeed, x, y);
        };
        const createItemWithSeed = (seed, x, y) => {
            let itemTeam = Team.getTeam(teamCounter);
            let worldPos = new MapBlockIndex(x, y).toWorldPosition();
            teamCounter = (teamCounter + 1) % 3;
            seed = seed % 10;
            if (0 <= seed && seed <= 9) {
                new spawnerBuilding.SmallAttackerSpawner(worldPos.getX(), worldPos.getY(), itemTeam);
            }
        };
        this.runFunctionOnEveryPosition(positionCreateItemFunction);
    }
    getPositionSeed(x, y) {
        x += this._integerMapSize;
        y += this._integerMapSize;
        let posNumber = this._integerMapSize * y + x;
        let posArg = SeedRandomBuilder.seedRandomFunction(posNumber, 4, 3);
        return SeedRandomBuilder.seedRandomFunction(posArg + this._seedArg, 4, 3);
    }
    checkPositionCanBuildBlock(builder, x, y) {
        let mapIndex = new MapBlockIndex(x, y);
        if (mapBlock.MapBlock.getBlock(mapIndex) != null)
            return false;
        let checkPos = mapIndex.getAroundPosition4();
        let linkSeedTable = [1234, 5000, 7000, 9000, 10000];
        let aroundBlockCount = 0;
        let posSeed = builder.getPositionSeed(x, y);
        for (var i = 0; i < checkPos.length; i++) {
            if (mapBlock.MapBlock.getBlock(checkPos[i]) == null)
                continue;
            aroundBlockCount += 1;
        }
        return (posSeed <= linkSeedTable[aroundBlockCount]);
    }
}
export class CircleMapBuilder extends MapBuilder {
    constructor(mapSize, circleNumber, degreeOffset = null) {
        super(mapSize);
        this._circleNumber = circleNumber;
        this._circleDistance = this._mapSize / this._circleNumber;
        if (degreeOffset == null) {
            this._degreeOffset = randomRange(0, Math.PI * 2);
        }
        else {
            this._degreeOffset = degreeOffset;
        }
    }
    buildNewMap() {
        super.buildNewMap();
        this.processBuildMapBlock();
        this.processCreateItem();
    }
    buildCircle(size) {
        const cirleFunction = (builder, x, y) => {
            let distance = getDistance(x, y, 0, 0);
            if (Math.abs(distance - size) <= 1.1) {
                new mapBlock.NormalMapBlock(x, y);
            }
        };
        this.runFunctionOnEveryPosition(cirleFunction);
    }
    processBuildMapBlock() {
        for (var i = 1; i <= this._circleNumber; i++) {
            this.buildCircle(i * this._circleDistance);
        }
        for (var i = 0; i < 3; i++) {
            let degree = i * 2 * Math.PI / 3 + this._degreeOffset;
            console.log(degree);
            let targetPosition = new MapBlockIndex(this._mapSize * Math.cos(degree), this._mapSize * Math.sin(degree));
            console.log(targetPosition.toString());
            MapBuilder.buildLine(targetPosition, new MapBlockIndex(0, 0));
        }
    }
    processCreateItem() {
        for (var i = 1; i <= this._circleNumber; i++) {
            this.createItemsOnCircle(i * this._circleDistance);
        }
    }
    createItemsOnCircle(size) {
        let itemNumber = Math.ceil(size / 7.25);
        let degreeSeg = 2 * Math.PI / (3 * (2 * itemNumber + 5));
        for (let i = 0; i < 3; i++) {
            let centerDegree = i * 2 * Math.PI / 3 + this._degreeOffset;
            console.log(centerDegree);
            for (let j = -itemNumber; j <= itemNumber; j++) {
                let itemDegree = centerDegree + j * degreeSeg;
                let indexPosition = new MapBlockIndex(size * Math.cos(itemDegree), size * Math.sin(itemDegree));
                let itemPosition = indexPosition.toWorldPosition();
                new spawnerBuilding.SmallAttackerSpawner(itemPosition.getX(), itemPosition.getY(), Team.getTeam(i));
            }
        }
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFwQnVpbGRlci5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uL3NyYy9tYXBCdWlsZGVyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sS0FBSyxRQUFRLE1BQU0sZUFBZSxDQUFDO0FBQzFDLE9BQU8sS0FBSyxlQUFlLE1BQU0sc0JBQXNCLENBQUM7QUFFeEQsT0FBTyxFQUFFLFdBQVcsRUFBRSxNQUFNLFlBQVksQ0FBQztBQUN6QyxPQUFPLEVBQUUsU0FBUyxFQUFFLE1BQU0sZ0JBQWdCLENBQUM7QUFDM0MsT0FBTyxFQUFFLElBQUksRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBQ3RDLE9BQU8sRUFBRSxhQUFhLEVBQWlCLE1BQU0sZUFBZSxDQUFDO0FBQzdELE9BQU8sRUFBRSxXQUFXLEVBQUUsTUFBSyxZQUFZLENBQUM7QUFFeEMsT0FBTyxDQUFDLEdBQUcsQ0FBQywrQkFBK0IsQ0FBQyxDQUFDO0FBRTdDLE1BQU0sT0FBZ0IsVUFBVTtJQXFDNUIsWUFBYSxPQUFjO1FBQ3ZCLElBQUksQ0FBQyxRQUFRLEdBQUcsT0FBTyxDQUFDO1FBQ3hCLElBQUksQ0FBQyxlQUFlLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBRSxJQUFJLENBQUMsUUFBUSxDQUFFLENBQUM7SUFDdEQsQ0FBQztJQXRDUyxNQUFNLENBQUMsU0FBUyxDQUFDLFNBQXVCLEVBQUUsU0FBdUIsRUFBRSxRQUFhLENBQUM7UUFFdkYsTUFBTSxhQUFhLEdBQUcsR0FBRSxFQUFFO1lBQ3RCLElBQUksU0FBUyxDQUFDLElBQUksRUFBRSxJQUFJLFNBQVMsQ0FBQyxJQUFJLEVBQUU7Z0JBQUUsT0FBTztZQUNqRCxJQUFJLE1BQU0sR0FBRyxDQUFFLFNBQVMsQ0FBQyxJQUFJLEVBQUUsR0FBRyxTQUFTLENBQUMsSUFBSSxFQUFFLENBQUUsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFFLFNBQVMsQ0FBQyxJQUFJLEVBQUUsR0FBRyxTQUFTLENBQUMsSUFBSSxFQUFFLENBQUUs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